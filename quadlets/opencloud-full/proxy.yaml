# This adds four additional routes to the proxy. Forwarding
# request on '/carddav/', '/caldav/' and the respective '/.well-knwown'
# endpoints to the radicale container and setting the required headers.
additional_policies:
  - name: default
    routes:
      # ---------------- WOPI / Collaboration ----------------
      - endpoint: /wopi/
        backend: http://collaboration:9300
        remote_user_header: X-Remote-User
        skip_x_access_token: false
        additional_headers:
          - X-Script-Name: /wopi
      - endpoint: /.well-known/wopi
        backend: http://collaboration:9300
        remote_user_header: X-Remote-User
        skip_x_access_token: false
        additional_headers:
          - X-Script-Name: /wopi

      # ---------------- Collabora Online ----------------
      - endpoint: /loleaflet/
        backend: http://collabora:9980
        remote_user_header: X-Remote-User
        skip_x_access_token: false
      - endpoint: /hosting/discovery
        backend: http://collabora:9980
        remote_user_header: X-Remote-User
        skip_x_access_token: false

      # ---------------- Cal/CardDAV (bereits vorhanden) ----------------
      - endpoint: /caldav/
        backend: http://radicale:5232
        remote_user_header: X-Remote-User
        skip_x_access_token: true
        additional_headers:
          - X-Script-Name: /caldav
      - endpoint: /.well-known/caldav
        backend: http://radicale:5232
        remote_user_header: X-Remote-User
        skip_x_access_token: true
        additional_headers:
          - X-Script-Name: /caldav
      - endpoint: /carddav/
        backend: http://radicale:5232
        remote_user_header: X-Remote-User
        skip_x_access_token: true
        additional_headers:
          - X-Script-Name: /carddav
      - endpoint: /.well-known/carddav
        backend: http://radicale:5232
        remote_user_header: X-Remote-User
        skip_x_access_token: true
        additional_headers:
          - X-Script-Name: /carddav
